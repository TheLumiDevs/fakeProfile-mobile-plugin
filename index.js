(function(E,N,I,e,A,c,p,g,s,m,$){"use strict";const{View:V,TouchableOpacity:j,Text:se}=e.ReactNative,W=[{hex:"FF0000",name:"Red"},{hex:"00FF00",name:"Green"},{hex:"0000FF",name:"Blue"},{hex:"FFFF00",name:"Yellow"},{hex:"FF00FF",name:"Magenta"},{hex:"00FFFF",name:"Cyan"},{hex:"FFFFFF",name:"White"},{hex:"000000",name:"Black"}],C=e.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",flexWrap:"wrap",padding:10},colorBox:{width:40,height:40,margin:5,borderRadius:8,borderWidth:2},selected:{borderColor:"#fff"},unselected:{borderColor:"transparent"}});function O(n){let{value:t,onChange:r}=n;return e.React.createElement(V,{style:C.container},W.map(function(a){return e.React.createElement(j,{key:a.hex,onPress:function(){return r(a.hex)},style:[C.colorBox,{backgroundColor:`#${a.hex}`},t===a.hex?C.selected:C.unselected],accessibilityLabel:a.name})}))}const{View:S,Text:D,TouchableOpacity:_,Modal:z}=A.General,u=e.stylesheet.createThemedStyleSheet({overlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:8,padding:20,minWidth:300,maxWidth:350,margin:20},title:{color:"#ffffff",fontSize:18,fontWeight:"600",textAlign:"center",marginBottom:20},preview:{flexDirection:"row",alignItems:"center",marginBottom:15,padding:8,backgroundColor:"#1e1f22",borderRadius:6},colorBox:{width:32,height:32,borderRadius:6,marginRight:10,borderWidth:1,borderColor:"#ffffff20"},colorText:{color:"#ffffff",fontSize:14,fontWeight:"500",fontFamily:"monospace"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:20,gap:10},button:{flex:1,paddingVertical:12,paddingHorizontal:16,borderRadius:6,alignItems:"center"},cancelButton:{backgroundColor:"#4f545c"},confirmButton:{backgroundColor:"#5865f2"},buttonText:{color:"#ffffff",fontSize:14,fontWeight:"600"}});function P(n){let{visible:t,title:r,initialValue:a="",onConfirm:i,onCancel:b}=n;const[o,h]=e.React.useState(a);e.React.useEffect(function(){h(a)},[a,t]);const w=function(){i(o)};return e.React.createElement(z,{visible:t,transparent:!0,animationType:"fade"},e.React.createElement(_,{style:u.overlay,onPress:b,activeOpacity:1},e.React.createElement(_,{style:u.modal,activeOpacity:1},e.React.createElement(D,{style:u.title},r),e.React.createElement(S,{style:u.preview},e.React.createElement(S,{style:[u.colorBox,{backgroundColor:o?`#${o}`:"#000000"}]}),e.React.createElement(e.ReactNative.TextInput,{style:[u.colorText,{backgroundColor:"#1e1f22",paddingHorizontal:8,paddingVertical:4,borderRadius:4,minWidth:80}],value:o,placeholder:"000000",placeholderTextColor:"#ffffff",onChangeText:h,maxLength:6})),e.React.createElement(O,{value:o,onChange:h}),e.React.createElement(S,{style:u.buttonRow},e.React.createElement(_,{style:[u.button,u.cancelButton],onPress:b},e.React.createElement(D,{style:u.buttonText},"Cancel")),e.React.createElement(_,{style:[u.button,u.confirmButton],onPress:w},e.React.createElement(D,{style:u.buttonText},"Confirm"))))))}const{ScrollView:G}=A.General,{FormSection:F,FormRow:l,FormSwitchRow:R}=A.Forms;function H(){$.useProxy(s.storage);const[n,t]=e.React.useState(!1),[r,a]=e.React.useState(!1),i=function(o,h){const w=`[#${o.toString(16).padStart(6,"0")},#${h.toString(16).padStart(6,"0")}]`;return" "+Array.from(w).map(function(v){return v.codePointAt(0)}).filter(function(v){return v>=32&&v<=127}).map(function(v){return String.fromCodePoint(v+917504)}).join("")},b=async function(){try{var o,h;const w=((o=s.storage.sw_primary)===null||o===void 0?void 0:o.padStart(6,"0"))||"000000",x=((h=s.storage.sw_accent)===null||h===void 0?void 0:h.padStart(6,"0"))||"000000";if(!/^[0-9A-Fa-f]{6}$/.test(w)||!/^[0-9A-Fa-f]{6}$/.test(x))throw new Error("Invalid hex color");const v=i(parseInt(w,16),parseInt(x,16));e.clipboard.setString(v),m.showToast("Copied to clipboard!",c.getAssetIDByName("check"))}catch{m.showToast("Failed to copy 3y3 color",c.getAssetIDByName("small"))}};return e.React.createElement(G,null,e.React.createElement(F,{title:"Settings"},e.React.createElement(R,{label:"Enable profile effects",subLabel:"If enabled, profile effects will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_effects,onValueChange:function(o){return s.storage.sw_effects=o}}),e.React.createElement(R,{label:"Enable profile themes",subLabel:"If enabled, profile themes will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_themes,onValueChange:function(o){return s.storage.sw_themes=o}}),e.React.createElement(R,{label:"Enable profile avatar decoration",subLabel:"If enabled, profile avatar decoration will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_decorations,onValueChange:function(o){return s.storage.sw_decorations=o}}),e.React.createElement(R,{label:"Enable profile banners",subLabel:"If enabled, profile effects will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_banners,onValueChange:function(o){return s.storage.sw_banners=o}}),e.React.createElement(R,{label:"Enable profile avatars",subLabel:"If enabled, profile avatars will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_avatars,onValueChange:function(o){return s.storage.sw_avatars=o}}),e.React.createElement(R,{label:"Enable custom badges",subLabel:"If enabled, custom badges will load up.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("settings")}),value:s.storage.sw_badges,onValueChange:function(o){return s.storage.sw_badges=o}})),e.React.createElement(F,{title:"3y3 Colors"},e.React.createElement(l,{label:"Primary Color",subLabel:`Current: ${s.storage.sw_primary||"none"}`,leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("ic_message_edit")}),onPress:function(){return t(!0)}}),e.React.createElement(l,{label:"Accent Color",subLabel:`Current: ${s.storage.sw_accent||"none"}`,leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("ic_message_edit")}),onPress:function(){return a(!0)}}),e.React.createElement(l,{label:"Copy 3y3",subLabel:"Copy encoded color string",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("copy")}),onPress:b})),e.React.createElement(F,{title:"Extras"},e.React.createElement(l,{label:"Discord Server",subLabel:"Join to Discord server for request profile avatar/banner/badge and choose decorations and effects.",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("Discord")}),trailing:l.Arrow,onPress:function(){return e.url.openDeeplink("https://discord.gg/ffmkewQ4R7")}}),e.React.createElement(l,{label:"Refetch fakeProfile",leading:e.React.createElement(l.Icon,{source:c.getAssetIDByName("ic_message_retry")}),trailing:l.Arrow,onPress:async function(){return await B()?m.showToast("Refetched fakeProfile",c.getAssetIDByName("check")):m.showToast("Failed to refetch fakeProfile",c.getAssetIDByName("small"))}})),e.React.createElement(P,{visible:n,title:"Select Primary Color",initialValue:s.storage.sw_primary||"",onConfirm:function(o){s.storage.sw_primary=o,t(!1)},onCancel:function(){return t(!1)}}),e.React.createElement(P,{visible:r,title:"Select Accent Color",initialValue:s.storage.sw_accent||"",onConfirm:function(o){s.storage.sw_accent=o,a(!1)},onCancel:function(){return a(!1)}}))}const K=p.findByProps("default","getUserBannerURL"),M=p.findByStoreName("UserStore"),q=p.findByProps("getAvatarDecorationURL","default"),J=p.findByProps("isAnimatedAvatarDecoration"),Q=p.findByName("useBadges",!1),Y=p.findByStoreName("UserProfileStore"),U=p.findByProps("getUserAvatarURL","getUserAvatarSource"),X=p.findByProps("getProfileEffectById"),y="https://fakeprofile.sampath.me",Z=y+"/users/all",ee="100101099222222",te="100101099222224";let f={},k={},d=[],L=[],T={};const B=async function(){try{f=await(await I.safeFetch(Z,{cache:"no-store"})).json(),k=await(await I.safeFetch(y+"/profile-effects",{cache:"no-store"})).json(),L=await(await I.safeFetch(y+"/badges",{cache:"no-store"})).json();const n=await(await I.safeFetch(y+"/decorations",{cache:"no-store"})).json();return T=Object.fromEntries(n.map(function(t){return[t.asset,{asset:t.asset,skuId:t.skuId,animated:t.animated}]})),f}catch(n){N.logger.error("Failed to fetch fakeProfile data",n)}};function ae(n){if(n==null)return null;const t=n.match(/\u{e005b}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e002c}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e005d}/u);if(t!=null){const r=[...t[0]].map(function(a){return String.fromCodePoint(a.codePointAt(0)-917504)}).join("");return r.substring(1,r.length-1).split(",").map(function(a){return parseInt(a.replace("#","0x"),16)})}else return null}const re=async function(){await B(),d.push(g.after("getUserProfile",Y,function(n,t){var r;if(!t)return t;const a=ae(t.bio);if(!((r=f[t.userId])===null||r===void 0)&&r.profileEffectId&&s.storage.sw_effects){var i;t.profileEffectId=t.profileEffectID=(i=f[t.userId])===null||i===void 0?void 0:i.profileEffectId,t.premiumType=2}return a&&s.storage.sw_themes&&(t.themeColors=a,t.premiumType=2),t})),d.push(g.after("getUserAvatarURL",U,function(n){let[{id:t},r]=n;if(f[t]&&f[t].avatar&&s.storage.sw_avatars){const a=f[t].avatar.toString();if(r)return a;{const i=new URL(a).pathname.split("/").pop().replace("a_","");return`${y}/image/${i}`}}})),d.push(g.after("getUserAvatarSource",U,function(n,t){let[{id:r},a]=n;if(f[r]&&f[r].avatar&&s.storage.sw_avatars){const i=f[r].avatar.toString();if(a)return{uri:i};{const b=new URL(i).pathname.split("/").pop().replace("a_","");return{uri:`${y}/image/${b}`}}}})),d.push(g.after("getUserBannerURL",K,function(n){let[t]=n;const r=Object.entries(f).find(function(i){return i[0]===t?.id});if(t?.banner===void 0&&r&&s.storage.sw_banners){var a;return(a=f[t?.id])===null||a===void 0?void 0:a.banner}})),d.push(g.after("getProfileEffectById",X,function(n,t){return k[n]})),d.push(g.after("getUser",M,function(n,t){if(t&&f[t?.id]&&f[t?.id].decoration&&s.storage.sw_decorations){const r=f[t?.id];if(r?.decoration){const a=T[r.decoration];a&&(t.avatarDecoration={asset:a?.asset,skuId:a?.skuId})}t.avatarDecorationData=t.avatarDecoration}})),d.push(g.instead("getAvatarDecorationURL",q,function(n,t){const[{avatarDecoration:r,canAnimate:a}]=n;if(r?.skuId===te){const i=r.asset.split("_");return!a&&i[0]==="a"&&i.shift(),y+`/avatar-decoration-presets/${i.join("_")}.png`}else if(r?.skuId===ee){const i=r.asset.split("_");return!a&&i[0]==="a"&&i.shift(),`https://cdn.discordapp.com/avatar-decoration-presets//${i.join("_")}.png`}else return t(...n)})),d.push(g.after("isAnimatedAvatarDecoration",J,function(n,t){let[r]=n;var a;if(e.ReactNative.Platform.OS==="ios"&&!(r==null||(a=r.asset)===null||a===void 0)&&a.startsWith("file://"))return!0})),d.push(g.after("default",Q,function(n,t){let[r]=n;if(!s.storage.sw_badges)return t;const a=r?.userId,i=L[a];return i?.length?[...i.map(function(b,o){return{id:`fakeprofile-${a}-${o}`,icon:b.badge,description:b.tooltip}}),...Array.isArray(t)?t:[]]:t})),setInterval(async function(){await B()},36e5)},ne=function(){return d.forEach(function(n){return n()})},oe=H;return E.fetchData=B,E.onLoad=re,E.onUnload=ne,E.settings=oe,E})({},vendetta,vendetta.utils,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.ui.toasts,vendetta.storage);
