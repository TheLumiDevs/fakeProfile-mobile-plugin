(function(w,P,y,I,r,A,c,g,d,n,B,E){"use strict";const{ScrollView:S,TextInput:W,View:z}=A.General,{FormSection:R,FormRow:i,FormSwitchRow:b,FormRadioRow:H}=A.Forms;function U(){B.useProxy(n.storage);const s=function(e,a){const o=`[#${e.toString(16).padStart(6,"0")},#${a.toString(16).padStart(6,"0")}]`;return" "+Array.from(o).map(function(f){return f.codePointAt(0)}).filter(function(f){return f>=32&&f<=127}).map(function(f){return String.fromCodePoint(f+917504)}).join("")},t=async function(){try{var e,a;const o=((e=n.storage.sw_primary)===null||e===void 0?void 0:e.padStart(6,"0"))||"000000",v=((a=n.storage.sw_accent)===null||a===void 0?void 0:a.padStart(6,"0"))||"000000";if(!/^[0-9A-Fa-f]{6}$/.test(o)||!/^[0-9A-Fa-f]{6}$/.test(v))throw new Error("Invalid hex color");const f=s(parseInt(o,16),parseInt(v,16));r.clipboard.setString(f),I.showToast("Copied to clipboard!",c.getAssetIDByName("check"))}catch{I.showToast("Failed to copy 3y3 color",c.getAssetIDByName("small"))}};return r.React.createElement(S,null,r.React.createElement(R,{title:"Settings"},r.React.createElement(b,{label:"Enable profile effects",subLabel:"If enabled, profile effects will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_effects,onValueChange:function(e){return n.storage.sw_effects=e}}),r.React.createElement(b,{label:"Enable profile themes",subLabel:"If enabled, profile themes will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_themes,onValueChange:function(e){return n.storage.sw_themes=e}}),r.React.createElement(b,{label:"Enable profile avatar decoration",subLabel:"If enabled, profile avatar decoration will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_decorations,onValueChange:function(e){return n.storage.sw_decorations=e}}),r.React.createElement(b,{label:"Enable profile banners",subLabel:"If enabled, profile effects will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_banners,onValueChange:function(e){return n.storage.sw_banners=e}}),r.React.createElement(b,{label:"Enable profile avatars",subLabel:"If enabled, profile avatars will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_avatars,onValueChange:function(e){return n.storage.sw_avatars=e}}),r.React.createElement(b,{label:"Enable custom badges",subLabel:"If enabled, custom badges will load up.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("settings")}),value:n.storage.sw_badges,onValueChange:function(e){return n.storage.sw_badges=e}})),r.React.createElement(R,{title:"3y3 Colors"},r.React.createElement(i,{label:"Primary Color",subLabel:`Current: ${n.storage.sw_primary||"none"}`,leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("ic_message_edit")}),onPress:function(){E.showInputAlert({title:"Enter Primary Color",placeholder:"ff0000",initialValue:n.storage.sw_primary,onConfirm:function(e){n.storage.sw_primary=e}})}}),r.React.createElement(i,{label:"Accent Color",subLabel:`Current: ${n.storage.sw_accent||"none"}`,leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("ic_message_edit")}),onPress:function(){E.showInputAlert({title:"Enter Accent Color",placeholder:"00ff00",initialValue:n.storage.sw_accent,onConfirm:function(e){n.storage.sw_accent=e}})}}),r.React.createElement(i,{label:"Copy 3y3",subLabel:"Copy encoded color string",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("copy")}),onPress:t})),r.React.createElement(R,{title:"Extras"},r.React.createElement(i,{label:"Discord Server",subLabel:"Join to Discord server for request profile avatar/banner/badge and choose decorations and effects.",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("Discord")}),trailing:i.Arrow,onPress:function(){return r.url.openDeeplink("https://discord.gg/ffmkewQ4R7")}}),r.React.createElement(i,{label:"Refetch fakeProfile",leading:r.React.createElement(i.Icon,{source:c.getAssetIDByName("ic_message_retry")}),trailing:i.Arrow,onPress:async function(){return await h()?I.showToast("Refetched fakeProfile",c.getAssetIDByName("check")):I.showToast("Failed to refetch fakeProfile",c.getAssetIDByName("small"))}})))}const L=g.findByProps("default","getUserBannerURL"),C=g.findByStoreName("UserStore"),N=g.findByProps("getAvatarDecorationURL","default"),k=g.findByProps("isAnimatedAvatarDecoration"),$=g.findByName("useBadges",!1),F=g.findByStoreName("UserProfileStore"),D=g.findByProps("getUserAvatarURL","getUserAvatarSource"),V=g.findByProps("getProfileEffectById"),p="https://fakeprofile.is-always.online",j=p+"/v3/users/fakeProfile",T="100101099222222",O="100101099222224",K="v2.7";let l={},m={},_={},u=[];const h=async function(){try{return _=await(await y.safeFetch(p+"/fakeProfile",{cache:"no-store"})).json(),l=await(await y.safeFetch(j,{cache:"no-store"})).json(),m=await(await y.safeFetch(p+"/profile-effects",{cache:"no-store"})).json(),l}catch(s){P.logger.error("Failed to fetch fakeProfile data",s)}};function q(s){if(s==null)return null;const t=s.match(/\u{e005b}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e002c}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e005d}/u);if(t!=null){const e=[...t[0]].map(function(a){return String.fromCodePoint(a.codePointAt(0)-917504)}).join("");return e.substring(1,e.length-1).split(",").map(function(a){return parseInt(a.replace("#","0x"),16)})}else return null}const x=async function(){if(await h(),_?.version!=K)return I.showToast("A new version of the fakeProfile plugin is available. Please update as soon as possible.");u.push(d.after("getUserProfile",F,function(s,t){var e;if(!t)return t;const a=q(t.bio);if(!((e=l[t.userId])===null||e===void 0)&&e.profile_effect&&n.storage.sw_effects){var o;t.profileEffectId=t.profileEffectID=(o=l[t.userId])===null||o===void 0?void 0:o.profile_effect,t.premiumType=2}return a&&n.storage.sw_themes&&(t.themeColors=a,t.premiumType=2),t})),u.push(d.after("getUserAvatarURL",D,function(s){let[{id:t},e]=s;if(l[t]&&l[t].avatar&&n.storage.sw_avatars){const a=l[t].avatar.toString();if(e)return a;{const o=new URL(a).pathname.split("/").pop().replace("a_","");return`${p}/image/${o}`}}})),u.push(d.after("getUserAvatarSource",D,function(s,t){let[{id:e},a]=s;if(l[e]&&l[e].avatar&&n.storage.sw_avatars){const o=l[e].avatar.toString();if(a)return{uri:o};{const v=new URL(o).pathname.split("/").pop().replace("a_","");return{uri:`${p}/image/${v}`}}}})),u.push(d.after("getUserBannerURL",L,function(s){let[t]=s;const e=Object.entries(l).find(function(o){return o[0]===t?.id});if(t?.banner===void 0&&e&&n.storage.sw_banners){var a;return(a=l[t?.id])===null||a===void 0?void 0:a.banner}})),u.push(d.after("getProfileEffectById",V,function(s,t){return m[s]})),u.push(d.after("getUser",C,function(s,t){if(t&&l[t?.id]&&l[t?.id].decoration&&n.storage.sw_decorations){const e=l[t?.id];e?.decoration&&(t.avatarDecoration={asset:e.decoration.asset,skuId:e?.decoration.skuId}),t.avatarDecorationData=t.avatarDecoration}})),u.push(d.instead("getAvatarDecorationURL",N,function(s,t){const[{avatarDecoration:e,canAnimate:a}]=s;if(e?.skuId===O){const o=e.asset.split("_");return!a&&o[0]==="a"&&o.shift(),p+`/avatar-decoration-presets/${o.join("_")}.png`}else if(e?.skuId===T){const o=e.asset.split("_");return!a&&o[0]==="a"&&o.shift(),`https://cdn.discordapp.com/avatar-decoration-presets//${o.join("_")}.png`}else return t(...s)})),u.push(d.after("isAnimatedAvatarDecoration",k,function(s,t){let[e]=s;var a;if(r.ReactNative.Platform.OS==="ios"&&!(e==null||(a=e.asset)===null||a===void 0)&&a.startsWith("file://"))return!0})),u.push(d.after("default",$,function(s,t){let[e]=s;var a;if(!n.storage.sw_badges)return t;const o=e?.userId,v=(a=l[o])===null||a===void 0?void 0:a.badges;return v?.length?[...v.map(function(f,Q){return{id:`fakeprofile-${o}-${Q}`,icon:f.icon,description:f.description}}),...Array.isArray(t)?t:[]]:t})),setInterval(async function(){await h()},_?.reloadInterval)},G=function(){return u.forEach(function(s){return s()})},J=U;return w.fetchData=h,w.onLoad=x,w.onUnload=G,w.settings=J,w})({},vendetta,vendetta.utils,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.storage,vendetta.ui.alerts);
