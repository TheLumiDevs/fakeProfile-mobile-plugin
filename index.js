(function(E,T,A,I,e,S,f,v,b,i,$){"use strict";const{View:N,TouchableOpacity:V,Text:ie}=e.ReactNative,W=[{hex:"FF0000",name:"Red"},{hex:"00FF00",name:"Green"},{hex:"0000FF",name:"Blue"},{hex:"FFFF00",name:"Yellow"},{hex:"FF00FF",name:"Magenta"},{hex:"00FFFF",name:"Cyan"},{hex:"FFFFFF",name:"White"},{hex:"000000",name:"Black"}],C=e.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",flexWrap:"wrap",padding:10},colorBox:{width:40,height:40,margin:5,borderRadius:8,borderWidth:2},selected:{borderColor:"#fff"},unselected:{borderColor:"transparent"}});function j(o){let{value:t,onChange:r}=o;return e.React.createElement(N,{style:C.container},W.map(function(a){return e.React.createElement(V,{key:a.hex,onPress:function(){return r(a.hex)},style:[C.colorBox,{backgroundColor:`#${a.hex}`},t===a.hex?C.selected:C.unselected],accessibilityLabel:a.name})}))}const{View:m,Text:D,TouchableOpacity:_,Modal:O}=S.General,u=e.stylesheet.createThemedStyleSheet({overlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:8,padding:20,minWidth:300,maxWidth:350,margin:20},title:{color:"#ffffff",fontSize:18,fontWeight:"600",textAlign:"center",marginBottom:20},preview:{flexDirection:"row",alignItems:"center",marginBottom:15,padding:8,backgroundColor:"#1e1f22",borderRadius:6},colorBox:{width:32,height:32,borderRadius:6,marginRight:10,borderWidth:1,borderColor:"#ffffff20"},colorText:{color:"#ffffff",fontSize:14,fontWeight:"500",fontFamily:"monospace"},buttonRow:{flexDirection:"row",justifyContent:"space-between",marginTop:20,gap:10},button:{flex:1,paddingVertical:12,paddingHorizontal:16,borderRadius:6,alignItems:"center"},cancelButton:{backgroundColor:"#4f545c"},confirmButton:{backgroundColor:"#5865f2"},buttonText:{color:"#ffffff",fontSize:14,fontWeight:"600"}});function U(o){let{visible:t,title:r,initialValue:a="",onConfirm:s,onCancel:h}=o;const[n,d]=e.React.useState(a);e.React.useEffect(function(){d(a)},[a,t]);const w=function(){s(n)};return e.React.createElement(O,{visible:t,transparent:!0,animationType:"fade"},e.React.createElement(_,{style:u.overlay,onPress:h,activeOpacity:1},e.React.createElement(_,{style:u.modal,activeOpacity:1},e.React.createElement(D,{style:u.title},r),e.React.createElement(m,{style:u.preview},e.React.createElement(m,{style:[u.colorBox,{backgroundColor:n?`#${n}`:"#000000"}]}),e.React.createElement(e.ReactNative.TextInput,{style:[u.colorText,{backgroundColor:"#1e1f22",paddingHorizontal:8,paddingVertical:4,borderRadius:4,minWidth:80}],value:n,onChangeText:d,placeholderTextColor:"#666",maxLength:6,selectionColor:"#ffffff"})),e.React.createElement(j,{value:n,onChange:d}),e.React.createElement(m,{style:u.buttonRow},e.React.createElement(_,{style:[u.button,u.cancelButton],onPress:h},e.React.createElement(D,{style:u.buttonText},"Cancel")),e.React.createElement(_,{style:[u.button,u.confirmButton],onPress:w},e.React.createElement(D,{style:u.buttonText},"Confirm"))))))}const{ScrollView:z}=S.General,{FormSection:P,FormRow:l,FormSwitchRow:y}=S.Forms;function G(){$.useProxy(i.storage);const[o,t]=e.React.useState(!1),[r,a]=e.React.useState(!1),s=function(n,d){const w=`[#${n.toString(16).padStart(6,"0")},#${d.toString(16).padStart(6,"0")}]`;return" "+Array.from(w).map(function(p){return p.codePointAt(0)}).filter(function(p){return p>=32&&p<=127}).map(function(p){return String.fromCodePoint(p+917504)}).join("")},h=async function(){try{var n,d;const w=((n=i.storage.sw_primary)===null||n===void 0?void 0:n.padStart(6,"0"))||"000000",x=((d=i.storage.sw_accent)===null||d===void 0?void 0:d.padStart(6,"0"))||"000000";if(!/^[0-9A-Fa-f]{6}$/.test(w)||!/^[0-9A-Fa-f]{6}$/.test(x))throw new Error("Invalid hex color");const p=s(parseInt(w,16),parseInt(x,16));e.clipboard.setString(p),I.showToast("Copied to clipboard!",f.getAssetIDByName("check"))}catch{I.showToast("Failed to copy 3y3 color",f.getAssetIDByName("small"))}};return e.React.createElement(z,null,e.React.createElement(P,{title:"Settings"},e.React.createElement(y,{label:"Enable profile effects",subLabel:"If enabled, profile effects will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_effects,onValueChange:function(n){return i.storage.sw_effects=n}}),e.React.createElement(y,{label:"Enable profile themes",subLabel:"If enabled, profile themes will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_themes,onValueChange:function(n){return i.storage.sw_themes=n}}),e.React.createElement(y,{label:"Enable profile avatar decoration",subLabel:"If enabled, profile avatar decoration will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_decorations,onValueChange:function(n){return i.storage.sw_decorations=n}}),e.React.createElement(y,{label:"Enable profile banners",subLabel:"If enabled, profile effects will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_banners,onValueChange:function(n){return i.storage.sw_banners=n}}),e.React.createElement(y,{label:"Enable profile avatars",subLabel:"If enabled, profile avatars will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_avatars,onValueChange:function(n){return i.storage.sw_avatars=n}}),e.React.createElement(y,{label:"Enable custom badges",subLabel:"If enabled, custom badges will load up.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("settings")}),value:i.storage.sw_badges,onValueChange:function(n){return i.storage.sw_badges=n}})),e.React.createElement(P,{title:"3y3 Colors"},e.React.createElement(l,{label:"Primary Color",subLabel:`Current: ${i.storage.sw_primary||"none"}`,leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("ic_message_edit")}),onPress:function(){return t(!0)}}),e.React.createElement(l,{label:"Accent Color",subLabel:`Current: ${i.storage.sw_accent||"none"}`,leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("ic_message_edit")}),onPress:function(){return a(!0)}}),e.React.createElement(l,{label:"Copy 3y3",subLabel:"Copy encoded color string",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("copy")}),onPress:h})),e.React.createElement(P,{title:"Extras"},e.React.createElement(l,{label:"Discord Server",subLabel:"Join to Discord server for request profile avatar/banner/badge and choose decorations and effects.",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("Discord")}),trailing:l.Arrow,onPress:function(){return e.url.openDeeplink("https://discord.gg/ffmkewQ4R7")}}),e.React.createElement(l,{label:"Refetch fakeProfile",leading:e.React.createElement(l.Icon,{source:f.getAssetIDByName("ic_message_retry")}),trailing:l.Arrow,onPress:async function(){return await B()?I.showToast("Refetched fakeProfile",f.getAssetIDByName("check")):I.showToast("Failed to refetch fakeProfile",f.getAssetIDByName("small"))}})),e.React.createElement(U,{visible:o,title:"Select Primary Color",initialValue:i.storage.sw_primary||"",onConfirm:function(n){i.storage.sw_primary=n,t(!1)},onCancel:function(){return t(!1)}}),e.React.createElement(U,{visible:r,title:"Select Accent Color",initialValue:i.storage.sw_accent||"",onConfirm:function(n){i.storage.sw_accent=n,a(!1)},onCancel:function(){return a(!1)}}))}const H=v.findByProps("default","getUserBannerURL"),K=v.findByStoreName("UserStore"),M=v.findByProps("getAvatarDecorationURL","default"),q=v.findByProps("isAnimatedAvatarDecoration"),J=v.findByName("ProfileBadges",!1),Q=v.findByStoreName("UserProfileStore"),k=v.findByProps("getUserAvatarURL","getUserAvatarSource"),Y=v.findByProps("getProfileEffectById"),R="https://fakeprofile.is-always.online",X=R+"/v3/users/fakeProfile",Z="100101099222222",ee="100101099222224",te="v2.7";let c={},L={},F={},g=[];const B=async function(){try{return F=await(await A.safeFetch(R+"/fakeProfile",{cache:"no-store"})).json(),c=await(await A.safeFetch(X,{cache:"no-store"})).json(),L=await(await A.safeFetch(R+"/profile-effects",{cache:"no-store"})).json(),c}catch(o){T.logger.error("Failed to fetch fakeProfile data",o)}};function ae(o){if(o==null)return null;const t=o.match(/\u{e005b}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e002c}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e005d}/u);if(t!=null){const r=[...t[0]].map(function(a){return String.fromCodePoint(a.codePointAt(0)-917504)}).join("");return r.substring(1,r.length-1).split(",").map(function(a){return parseInt(a.replace("#","0x"),16)})}else return null}const re=async function(){if(await B(),F?.version!=te)return I.showToast("A new version of the fakeProfile plugin is available. Please update as soon as possible.");g.push(b.after("getUserProfile",Q,function(o,t){var r;if(!t)return t;const a=ae(t.bio);if(!((r=c[t.userId])===null||r===void 0)&&r.profile_effect&&i.storage.sw_effects){var s;t.profileEffectId=t.profileEffectID=(s=c[t.userId])===null||s===void 0?void 0:s.profile_effect,t.premiumType=2}return a&&i.storage.sw_themes&&(t.themeColors=a,t.premiumType=2),t})),g.push(b.after("getUserAvatarURL",k,function(o){let[{id:t},r]=o;if(c[t]&&c[t].avatar&&i.storage.sw_avatars){const a=c[t].avatar.toString();if(r)return a;{const s=new URL(a).pathname.split("/").pop().replace("a_","");return`${R}/image/${s}`}}})),g.push(b.after("getUserAvatarSource",k,function(o,t){let[{id:r},a]=o;if(c[r]&&c[r].avatar&&i.storage.sw_avatars){const s=c[r].avatar.toString();if(a)return{uri:s};{const h=new URL(s).pathname.split("/").pop().replace("a_","");return{uri:`${R}/image/${h}`}}}})),g.push(b.after("getUserBannerURL",H,function(o){let[t]=o;const r=Object.entries(c).find(function(s){return s[0]===t?.id});if(t?.banner===void 0&&r&&i.storage.sw_banners){var a;return(a=c[t?.id])===null||a===void 0?void 0:a.banner}})),g.push(b.after("getProfileEffectById",Y,function(o,t){return L[o]})),g.push(b.after("getUser",K,function(o,t){if(t&&c[t?.id]&&c[t?.id].decoration&&i.storage.sw_decorations){const r=c[t?.id];r?.decoration&&(t.avatarDecoration={asset:r.decoration.asset,skuId:r?.decoration.skuId}),t.avatarDecorationData=t.avatarDecoration}})),g.push(b.instead("getAvatarDecorationURL",M,function(o,t){const[{avatarDecoration:r,canAnimate:a}]=o;if(r?.skuId===ee){const s=r.asset.split("_");return!a&&s[0]==="a"&&s.shift(),R+`/avatar-decoration-presets/${s.join("_")}.png`}else if(r?.skuId===Z){const s=r.asset.split("_");return!a&&s[0]==="a"&&s.shift(),`https://cdn.discordapp.com/avatar-decoration-presets//${s.join("_")}.png`}else return t(...o)})),g.push(b.after("isAnimatedAvatarDecoration",q,function(o,t){let[r]=o;var a;if(e.ReactNative.Platform.OS==="ios"&&!(r==null||(a=r.asset)===null||a===void 0)&&a.startsWith("file://"))return!0})),g.push(b.after("default",J,function(o,t){let[r]=o;var a;if(!i.storage.sw_badges)return t;const s=r?.userId,h=(a=c[s])===null||a===void 0?void 0:a.badges;return h?.length?[...h.map(function(n,d){return{id:`fakeprofile-${s}-${d}`,icon:n.icon,description:n.description}}),...Array.isArray(t)?t:[]]:t})),setInterval(async function(){await B()},F?.reloadInterval)},ne=function(){return g.forEach(function(o){return o()})},oe=G;return E.fetchData=B,E.onLoad=re,E.onUnload=ne,E.settings=oe,E})({},vendetta,vendetta.utils,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.storage);
